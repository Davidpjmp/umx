% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/misc_and_utility.R
\name{umx_make_TwinData}
\alias{umx_make_TwinData}
\title{Simulate twin data with control over A, C, and E parameters, as well as moderation of A.}
\usage{
umx_make_TwinData(nMZpairs, nDZpairs = nMZpairs, AA = NULL,
  CC = NULL, EE = NULL, varNames = "var", scale = FALSE,
  mean = 0, sd = 1, nThresh = NULL, sum2one = TRUE, seed = NULL,
  empirical = FALSE, MZr = NULL, DZr = MZr, Amod = NULL,
  Cmod = NULL, Emod = NULL)
}
\arguments{
\item{nMZpairs}{Number of MZ pairs to simulate}

\item{nDZpairs}{Number of DZ pairs to simulate (defaults to nMZpairs)}

\item{AA}{value for A variance. NOTE: See options for use in GxE and Bivariate GxE}

\item{CC}{value for C variance.}

\item{EE}{value for E variance.}

\item{varNames}{name for variables (defaults to 'var')}

\item{scale}{Whether to scale output to var=1 mean=0 (Default FALSE)}

\item{mean}{mean for traits (default = 0) (not applied to moderated cases)}

\item{sd}{sd of traits (default = 1) (not applied to moderated cases)}

\item{nThresh}{If supplied, use as thresholds and return mxFactor output? (default is not to)}

\item{sum2one}{Whether to enforce AA + CC + EE summing the one (default = TRUE)}

\item{seed}{Allows user to set.seed() if wanting reproducible dataset}

\item{empirical}{Passed to mvrnorm}

\item{MZr}{If MZr and DZr are set (default = NULL), the function returns dataframes of the request n and correlation.}

\item{DZr}{NULL}

\item{Amod}{Used for Bivariate GxE data: list(Beta_a1 = .025, Beta_a2 = .025)}

\item{Cmod}{Used for Bivariate GxE data: list(Beta_c1 = .025, Beta_c2 = .025)}

\item{Emod}{Used for Bivariate GxE data: list(Beta_e1 = .025, Beta_e2 = .025)}
}
\value{
\itemize{
\item list of mzData and dzData dataframes containing T1 and T2 plus, if needed M1 and M2 (moderator values)
}
}
\description{
Makes MZ and DZ twin data, optionally with moderated A. By default, the three variance components must sum to 1.

See examples for how to use this: it is pretty flexible.

If you provide 2 varNames, they will be used for twin 1 and twin 2. If you provide one, it will be expanded to var_T1 and var_T2

You supply the number of pairs of each zygosity that wish to simulate (nMZpairs, nDZpairs), along with the values of AA, CC,and EE.

\emph{Note}, if you want a power calculator, see \href{https://www.people.vcu.edu/~bverhulst/power/power.html}{here}.

\strong{Shortcuts}

You can omit nDZpairs. You can also give any 2 of A, C, or E and the function will add the value which makes the ACE total = 1.

\strong{Moderation}
\strong{Univariate GxE Data}
\code{AA} can take a list c(avg = .5, min = 0, max = 1). If specified will act like a moderated heritability, with average value = avg, and swinging
down to min and up to max across 3 SDs of the moderator.

\strong{Bivariate GxE Data}

To simulate data with a moderator that is not shared by both twins.
Moderated heritability is specified via the bivariate relationship (AA, CC, EE) and two moderators in each component.
AA   = list(a11 = .4, a12 = .1, a22 = .15)
CC   = list(c11 = .2, c12 = .1, c22 = .10)
EE   = list(e11 = .4, e12 = .3, e22 = .25)
Amod = list(Beta_a1 = .025, Beta_a2 = .025)
Cmod = list(Beta_c1 = .025, Beta_c2 = .025)
Emod = list(Beta_e1 = .025, Beta_e2 = .025)
}
\examples{
# =====================================================================
# = Basic Example, with all elements of std univariate data specified =
# =====================================================================
tmp = umx_make_TwinData(nMZpairs = 10000, AA = .30, CC = .00, EE = .70)
# Show list of 2 data sets
str(tmp)
# = How to consume the built datasets =
mzData = tmp[tmp$zygosity == "MZ", ]
dzData = tmp[tmp$zygosity == "DZ", ]
cov(mzData); cov(dzData)
umxAPA(mzData)
str(mzData); str(dzData); 

# Prefer to work in path coefficient values? (little a?)
tmp = umx_make_TwinData(200, AA = .6^2, CC = .2^2)
# Check the correlations
umxAPA(subset(tmp, zygosity == "MZ")) 
umxAPA(subset(tmp, zygosity == "DZ"))

# =============
# = Shortcuts =
# =============

# Omit nDZpairs (equal numbers of both by default)
tmp = umx_make_TwinData(nMZpairs = 100, nDZpairs = 100, AA = .36, CC = .04, EE = .60)
tmp = umx_make_TwinData(100, AA = 0.5, CC = 0.3) # omit any one of A, C, or E (sums to 1)
cov(tmp[tmp$zygosity == "MZ", ])
# Not limited to unit variance
tmp = umx_make_TwinData(100, AA = 3, CC = 2, EE = 3, sum2one = FALSE) 
cov(tmp[tmp$zygosity == "MZ", ])

# =====================
# = Moderator Example =
# =====================

tmp = umx_make_TwinData(nMZpairs = 140, AA = c(avg = .5, min = .1, max = .8), CC = .35)
str(tmp)
m1 = umxGxE(selDVs = "var", selDefs = "M", sep = "_T", mzData = tmp[[1]], dzData = tmp[[2]])

# =====================
# = Threshold Example =
# =====================
tmp = umx_make_TwinData(100, AA = .6, CC = .2, nThresh = 3)
str(tmp)
umxAPA(tmp[[1]]); umxAPA(tmp[[2]])


# ========================
# = Just use MZr and DZr =
# ========================
tmp = umx_make_TwinData(100, MZr = .86, DZr = .60, varNames = "IQ")
umxAPA(subset(tmp, zygosity == "MZ")); umxAPA(subset(tmp, zygosity == "DZ"))

# Bivariate GxSES example (see umxGxEbiv)

AA   = list(a11 = .4, a12 = .1, a22 = .15)
CC   = list(c11 = .2, c12 = .1, c22 = .10)
EE   = list(e11 = .4, e12 = .3, e22 = .25)
Amod = list(Beta_a1 = .025, Beta_a2 = .025)
Cmod = list(Beta_c1 = .025, Beta_c2 = .025)
Emod = list(Beta_e1 = .025, Beta_e2 = .025)
tmp = umx_make_TwinData(5000, AA =AA, CC = CC, EE = EE, Amod = Amod, Cmod =Cmod, Emod =Emod)
# List of 2
# $ mzData:'data.frame':	5000 obs. of  6 variables:
#  ..$ defM_T1: num [1:5000] 0.472 1.186 -1.101 0.137 0.865 ...
#  ..$ defM_T2: num [1:5000] -0.577 1.129 -0.831 0.372 -0.385 ...
#  ..$ M_T1   : num [1:5000] 0.472 1.186 -1.101 0.137 0.865 ...
#  ..$ var_T1 : num [1:5000] 0.168 -1.002 -0.796 0.683 1.681 ...
#  ..$ M_T2   : num [1:5000] -0.577 1.129 -0.831 0.372 -0.385 ...
#  ..$ var_T2 : num [1:5000] -1.168 1.109 0.915 0.514 -0.562 ...
# $ dzData:'data.frame':	5000 obs. of  6 variables:
#  ..$ defM_T1: num [1:5000] 1.1 1.08 1.65 -1.99 1.38 ...
#  ..$ defM_T2: num [1:5000] 0.276 0.666 0.102 -0.31 0.925 ...
#  ..$ M_T1   : num [1:5000] 1.1 1.08 1.65 -1.99 1.38 ...
#  ..$ var_T1 : num [1:5000] 0.675 0.24 0.395 -1.372 2.057 ...
#  ..$ M_T2   : num [1:5000] 0.276 0.666 0.102 -0.31 0.925 ...
#  ..$ var_T2 : num [1:5000] 0.493 1.793 0.405 -0.173 0.482 ...

# TODO tmx example showing how moderation of A introduces heteroscedasticity in a regression model:
# More residual variance at one extreme of the x axis (moderator) 
# m1 = lm(var_T1~ M_T1, data = x); 
# x = rbind(tmp[[1]], tmp[[2]])
# plot(residuals(m1)~ x$M_T1, data=x)
}
\references{
\itemize{
\item \url{https://github.com/tbates/umx}, \url{https://tbates.github.io}
}
}
\seealso{
\itemize{
\item \code{\link{umx_make_TwinData}}, \code{\link{umxGxEbiv}}, \code{\link{umxACE}}, \code{\link{umxGxE}}
}

Other Twin Data functions: \code{\link{umx_long2wide}},
  \code{\link{umx_residualize}},
  \code{\link{umx_scale_wide_twin_data}},
  \code{\link{umx_wide2long}}, \code{\link{umx}}

Other Data Functions: \code{\link{umxCovData}},
  \code{\link{umxDescribeDataWLS}},
  \code{\link{umxHetCor}},
  \code{\link{umxPadAndPruneForDefVars}},
  \code{\link{umx_as_numeric}}, \code{\link{umx_cov2raw}},
  \code{\link{umx_lower2full}},
  \code{\link{umx_make_MR_data}},
  \code{\link{umx_make_bin_cont_pair_data}},
  \code{\link{umx_make_fake_data}},
  \code{\link{umx_polychoric}},
  \code{\link{umx_polypairwise}},
  \code{\link{umx_polytriowise}},
  \code{\link{umx_read_lower}}, \code{\link{umx_rename}},
  \code{\link{umx_reorder}},
  \code{\link{umx_select_valid}}, \code{\link{umx_stack}},
  \code{\link{umx_swap_a_block}}, \code{\link{umx}}
}
\concept{Data Functions}
\concept{Twin Data functions}
