% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/model_builders.r
\name{umxTwoStage}
\alias{umxTwoStage}
\title{umxTwoStage}
\usage{
umxTwoStage(formula, instruments, data, subset, weights, contrasts = NULL,
  name = "tsls", ...)
}
\arguments{
\item{formula}{for structural equation to be estimated; a regression constant is implied if not explicitly omitted.}

\item{instruments}{one-sided formula specifying instrumental variables.}

\item{data}{data.frame containing the variables in the model.}

\item{subset}{[optional] vector specifying a subset of observations to be used in fitting the model.}

\item{weights}{[optional] vector of weights to be used in the fitting process;
if specified should be a non-negative numeric vector with one entry for each observation,
to be used to compute weighted 2SLS estimates.}

\item{contrasts}{an optional list. See the contrasts.arg argument of model.matrix.default.}

\item{...}{arguments to be passed down.}

\item{digits}{number of digits for summary output.}
}
\value{
-
}
\description{
umxTwoStage implements 2-stage least squares regression in Structural Equation Modeling.
The function is modeled closely on the tsls function in the sem package for ease of learning.
}
\details{
The example is a Mendelian Randomization \url{https://en.wikipedia.org/wiki/Mendelian_randomization} 
analysis to show the value of two-stage.
}
\examples{
library(umx)

data("MR_data")
# ====================================
# = Mendelian randomization analysis =
# ====================================

m1 = umxTwoStage(Y ~ X, instruments = ~ qtl, data = MR_data)
coef(m1)
plot(m1)

# Errant analysis using ordinary least squares regression (WARNING this result is CONFOUNDED!!)
m1 = lm(Y ~ X    , data = MR_data); coef(m1) # "appears" that Y is caused by X:  𝛽= .35
m1 = lm(Y ~ X + U, data = MR_data); coef(m1) # Controlling U reveals the true link: 𝛽= 0.1
#
#
\dontrun{
# =========================
# = tsls from sem library =
# =========================
# library(sem) # will require you to install X11
m2 = tsls(formula = Y ~ X, instruments = ~ qtl, data = MR_data)

coef(m1)
coef(m2)
#                 Estimate  Std. Error   t value     Pr(>|t|)
# (Intercept) 0.0009797078 0.003053891 0.3208064 7.483577e-01
# X           0.1013835358 0.021147133 4.7941976 1.635616e-06
# X effect correctly estimated at .1 !!
}
}
\references{
- Fox, J. (1979) Simultaneous equation models and two-stage least-squares.
In Schuessler, K. F. (ed.) \emph{Sociological Methodology}, Jossey-Bass., 
Greene, W. H. (1993) \emph{Econometric Analysis}, Second Edition, Macmillan.
}
\seealso{
- \code{\link{umxRAM}}, \code{\link{tsls}}

Other Super-easy helpers: \code{\link{umxEFA}},
  \code{\link{umx}}
}

